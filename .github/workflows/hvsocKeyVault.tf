# azurerm_key_vault.hvsocKeyVault:
resource "azurerm_key_vault" "hvsocKeyVault" {
    access_policy                   = [
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "1af2d7b8-ebba-4922-bb13-101bc65a5174"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Backup",
                "Restore",
                "Recover",
            ]
            object_id               = "28f89408-861c-4a4b-823c-ff981a23d069"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Recover",
                "Delete",
                "Backup",
                "Restore",
            ]
            object_id               = "0d4a80c9-72b0-45fb-b68d-82cd8f02680e"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "7a618a0a-8dbd-4d8a-9ff4-d00d569ac53d"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "84d82fb2-dd40-4dcc-ae35-6591b30fbf8c"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "06526e43-b295-4379-aed6-02bf1c13abf5"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "13042750-e5c2-40fe-95ad-c13c58d9c528"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "45a38c8d-62a1-4e2a-8a4d-9ac854a8efe8"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "e060acd8-6f0e-4084-8095-313d8168612f"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "0ddb6033-4fd0-4d04-9226-09fc163b6108"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "0c7aa273-2989-45f2-b7f7-c724d581083c"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "d254b5ce-072e-490d-aa1f-37f1798d66bd"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "8b7520d3-7909-40e3-bf9c-8b052d8448bc"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
        {
            application_id          = ""
            certificate_permissions = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
                "ManageContacts",
                "ManageIssuers",
                "GetIssuers",
                "ListIssuers",
                "SetIssuers",
                "DeleteIssuers",
            ]
            key_permissions         = [
                "Get",
                "List",
                "Update",
                "Create",
                "Import",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            object_id               = "cbcd42b1-a7d7-479e-a100-c1bd8503bc7d"
            secret_permissions      = [
                "Get",
                "List",
                "Set",
                "Delete",
                "Recover",
                "Backup",
                "Restore",
            ]
            storage_permissions     = []
            tenant_id               = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
        },
    ]
    enable_rbac_authorization       = false
    enabled_for_deployment          = false
    enabled_for_disk_encryption     = false
    enabled_for_template_deployment = false

    location                        = "japaneast"
    name                            = var.hvsocKeyVault_name
    purge_protection_enabled        = false
    resource_group_name             = var.resorcegroup_hvsoc_siempf_name
    sku_name                        = "standard"
#   comment: Azure has removed spport for disabling soft delete
#    soft_delete_enabled             = true
    soft_delete_retention_days      = 90
    tags                            = {}
    tenant_id                       = "f54277c9-dafe-44aa-85a4-73d5c7c52450"
#    vault_uri                       = "https://hvsockeyvault.vault.azure.net/"

    network_acls {
        bypass                     = "AzureServices"
        default_action             = "Deny"
        ip_rules                   = [
              "133.145.228.11/32",
              "133.145.228.12/32",
              "133.145.228.13/32",
              "202.246.251.240/28",
              "202.246.252.128/25",
              "202.246.252.96/27",
        ]
        virtual_network_subnet_ids = [
#            var.hvsoc0101-logcollnfs-vnet_default_subnet_id,
            azurerm_subnet.hvsoc_siempf_subnet-container-instances_Subnet.id,
            azurerm_subnet.hvsoc_siempf_subnet-indexer_Subnet.id,
            azurerm_subnet.hvsoc_siempf_subnet-redmine_Subnet.id,
        ]
    }

    timeouts {}
        depends_on = [
        azurerm_resource_group.hvsoc_siempf,
        azurerm_subnet.hvsoc_siempf_subnet-container-instances_Subnet,
        azurerm_subnet.hvsoc_siempf_subnet-indexer_Subnet,
        azurerm_subnet.hvsoc_siempf_subnet-redmine_Subnet,
    ]
}
